openapi: 3.0.0
info:
  title: ContentSafety Service
  version: 2023-10-15-preview
  description: Analyze harmful content
tags: []
paths:
  /image:analyze:
    post:
      operationId: ImageOperations_analyzeImage
      summary: Analyze Image
      description: 'A synchronous API for the analysis of potentially harmful image content. Currently, it supports four categories: Hate, SelfHarm, Sexual, and Violence.'
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeImageResult'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
      requestBody:
        description: The image analysis request.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalyzeImageOptions'
  /text/blocklists:
    get:
      operationId: TextBlocklists_listTextBlocklists
      summary: Get All Text Blocklists
      description: Get all text blocklists details.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedTextBlocklist'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
  /text/blocklists/{blocklistName}:
    get:
      operationId: TextBlocklists_getTextBlocklist
      summary: Get Text Blocklist By blocklistName
      description: Returns text blocklist details.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
        - name: blocklistName
          in: path
          required: true
          description: Text blocklist name.
          schema:
            type: string
            pattern: ^[0-9A-Za-z._~-]+$
            maxLength: 64
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TextBlocklist'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
    patch:
      operationId: TextBlocklists_createOrUpdateTextBlocklist
      summary: Create Or Update Text Blocklist
      description: Updates a text blocklist. If the blocklistName does not exist, a new blocklist will be created.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
        - name: blocklistName
          in: path
          required: true
          description: Text blocklist name.
          schema:
            type: string
            pattern: ^[0-9A-Za-z._~-]+$
            maxLength: 64
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TextBlocklist'
        '201':
          description: The request has succeeded and a new resource has been created as a result.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TextBlocklist'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
      requestBody:
        description: The resource instance.
        required: true
        content:
          application/merge-patch+json:
            schema:
              $ref: '#/components/schemas/TextBlocklistCreateOrUpdate'
    delete:
      operationId: TextBlocklists_deleteTextBlocklist
      summary: Delete Text Blocklist By blocklistName
      description: Deletes a text blocklist.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
        - name: blocklistName
          in: path
          required: true
          description: Text blocklist name.
          schema:
            type: string
            pattern: ^[0-9A-Za-z._~-]+$
            maxLength: 64
      responses:
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
  /text/blocklists/{blocklistName}/blocklistItems:
    get:
      operationId: TextBlocklists_listTextBlocklistItems
      summary: Get All BlocklistItems By blocklistName
      description: Get all blocklistItems in a text blocklist.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
        - name: blocklistName
          in: path
          required: true
          description: Text blocklist name.
          schema:
            type: string
            pattern: ^[0-9A-Za-z._~-]+$
            maxLength: 64
        - $ref: '#/components/parameters/Azure.Core.TopQueryParameter'
        - $ref: '#/components/parameters/Azure.Core.SkipQueryParameter'
        - $ref: '#/components/parameters/Azure.Core.MaxPageSizeQueryParameter'
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PagedTextBlocklistItem'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
  /text/blocklists/{blocklistName}/blocklistItems/{blocklistItemId}:
    get:
      operationId: TextBlocklists_getTextBlocklistItem
      summary: Get BlocklistItem By blocklistName And blocklistItemId
      description: Get blocklistItem by blocklistName and blocklistItemId from a text blocklist.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
        - name: blocklistName
          in: path
          required: true
          description: Text blocklist name.
          schema:
            type: string
            pattern: ^[0-9A-Za-z._~-]+$
            maxLength: 64
        - name: blocklistItemId
          in: path
          required: true
          description: The service will generate a BlocklistItemId, which will be a UUID.
          schema:
            type: string
            maxLength: 64
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TextBlocklistItem'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
  /text/blocklists/{blocklistName}:addOrUpdateBlocklistItems:
    post:
      operationId: TextBlocklists_addOrUpdateBlocklistItems
      summary: Add or update BlocklistItems To Text Blocklist
      description: Add or update blocklistItems to a text blocklist. You can add or update at most 100 blocklistItems in one request.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
        - name: blocklistName
          in: path
          required: true
          description: Text blocklist name.
          schema:
            type: string
            pattern: ^[0-9A-Za-z._~-]+$
            maxLength: 64
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AddOrUpdateTextBlocklistItemsResult'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
      requestBody:
        description: Options for adding or updating blocklist items.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddOrUpdateTextBlocklistItemsOptions'
  /text/blocklists/{blocklistName}:removeBlocklistItems:
    post:
      operationId: TextBlocklists_removeBlocklistItems
      summary: Remove BlocklistItems From Text Blocklist
      description: Remove blocklistItems from a text blocklist. You can remove at most 100 BlocklistItems in one request.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
        - name: blocklistName
          in: path
          required: true
          description: Text blocklist name.
          schema:
            type: string
            pattern: ^[0-9A-Za-z._~-]+$
            maxLength: 64
      responses:
        '204':
          description: 'There is no content to send for this request, but the headers may be useful. '
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
      requestBody:
        description: Options for removing blocklist items.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RemoveTextBlocklistItemsOptions'
  /text:analyze:
    post:
      operationId: TextOperations_analyzeText
      summary: Analyze Text
      description: 'A synchronous API for the analysis of potentially harmful text content. Currently, it supports four categories: Hate, SelfHarm, Sexual, and Violence.'
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeTextResult'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
      requestBody:
        description: The text analysis request.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalyzeTextOptions'
  /text:detectJailbreak:
    post:
      operationId: TextOperations_detectTextJailbreak
      summary: Analyze Text Jailbreak
      description: A synchronous API for the analysis of text jailbreak.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeTextJailbreakResult'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
      requestBody:
        description: The text jailbreak analysis request.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalyzeTextJailbreakOptions'
  /text:detectProtectedMaterial:
    post:
      operationId: TextOperations_detectTextProtectedMaterial
      summary: Analyze Protected Material
      description: A synchronous API for the analysis of protected material.
      parameters:
        - $ref: '#/components/parameters/Azure.Core.Foundations.ApiVersionParameter'
      responses:
        '200':
          description: The request has succeeded.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnalyzeTextProtectedMaterialResult'
        default:
          description: An unexpected error response.
          headers:
            x-ms-error-code:
              required: false
              description: String error code indicating what went wrong.
              schema:
                type: string
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Azure.Core.Foundations.ErrorResponse'
      requestBody:
        description: The text protected material analysis request.
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AnalyzeTextProtectedMaterialOptions'
security:
  - ApiKeyAuth: []
  - OAuth2Auth:
      - https://cognitiveservices.azure.com/.default
components:
  parameters:
    Azure.Core.Foundations.ApiVersionParameter:
      name: api-version
      in: query
      required: true
      description: The API version to use for this operation.
      schema:
        type: string
        minLength: 1
    Azure.Core.MaxPageSizeQueryParameter:
      name: maxpagesize
      in: query
      required: false
      description: The maximum number of result items per page.
      schema:
        type: integer
        format: int32
    Azure.Core.SkipQueryParameter:
      name: skip
      in: query
      required: false
      description: The number of result items to skip.
      schema:
        type: integer
        format: int32
        default: 0
    Azure.Core.TopQueryParameter:
      name: top
      in: query
      required: false
      description: The number of result items to return.
      schema:
        type: integer
        format: int32
  schemas:
    AddOrUpdateTextBlocklistItemsOptions:
      type: object
      required:
        - blocklistItems
      properties:
        blocklistItems:
          type: array
          items:
            $ref: '#/components/schemas/TextBlocklistItem'
          description: Array of blocklistItems to add.
      description: The request to add blocklistItems to a text blocklist.
    AddOrUpdateTextBlocklistItemsResult:
      type: object
      required:
        - blocklistItems
      properties:
        blocklistItems:
          type: array
          items:
            $ref: '#/components/schemas/TextBlocklistItem'
          description: Array of blocklistItems have been added.
      description: The response of adding blocklistItems to the text blocklist.
    AnalyzeImageOptions:
      type: object
      required:
        - image
      properties:
        image:
          allOf:
            - $ref: '#/components/schemas/ImageData'
          description: The image needs to be analyzed.
        categories:
          type: array
          items:
            $ref: '#/components/schemas/ImageCategory'
          description: The categories will be analyzed. If they are not assigned, a default set of analysis results for the categories will be returned.
        outputType:
          allOf:
            - $ref: '#/components/schemas/AnalyzeImageOutputType'
          description: This refers to the type of image analysis output. If no value is assigned, the default value will be "FourSeverityLevels".
          default: FourSeverityLevels
      description: The image analysis request.
    AnalyzeImageOutputType:
      type: string
      enum:
        - FourSeverityLevels
      description: The type of image analysis output.
    AnalyzeImageResult:
      type: object
      required:
        - categoriesAnalysis
      properties:
        categoriesAnalysis:
          type: array
          items:
            $ref: '#/components/schemas/ImageCategoriesAnalysis'
          description: Analysis result for categories.
      description: The image analysis response.
    AnalyzeTextJailbreakOptions:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          maxLength: 1000
          description: The text needs to be analyzed if it attempt to jailbreak. We support a maximum of 1k Unicode characters (Unicode code points) in the text of one request.
      description: The text jailbreak analysis request.
    AnalyzeTextJailbreakResult:
      type: object
      required:
        - jailbreakAnalysis
      properties:
        jailbreakAnalysis:
          allOf:
            - $ref: '#/components/schemas/JailbreakAnalysisResult'
          description: Analysis result for jailbreak.
      description: The text jailbreak analysis request.
    AnalyzeTextOptions:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          maxLength: 10000
          description: The text needs to be analyzed. We support a maximum of 10k Unicode characters (Unicode code points) in the text of one request.
        categories:
          type: array
          items:
            $ref: '#/components/schemas/TextCategory'
          description: The categories will be analyzed. If they are not assigned, a default set of analysis results for the categories will be returned.
        blocklistNames:
          type: array
          items:
            type: string
          description: The names of blocklists.
        haltOnBlocklistHit:
          type: boolean
          description: When set to true, further analyses of harmful content will not be performed in cases where blocklists are hit. When set to false, all analyses of harmful content will be performed, whether or not blocklists are hit.
        outputType:
          allOf:
            - $ref: '#/components/schemas/AnalyzeTextOutputType'
          description: This refers to the type of text analysis output. If no value is assigned, the default value will be "FourSeverityLevels".
          default: FourSeverityLevels
      description: The text analysis request.
    AnalyzeTextOutputType:
      type: string
      enum:
        - FourSeverityLevels
        - EightSeverityLevels
      description: The type of text analysis output.
    AnalyzeTextProtectedMaterialOptions:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          maxLength: 1000
          description: The text needs to be analyzed. We support a maximum of 1k Unicode characters (Unicode code points) in the text of one request.
      description: The protected material analysis request.
    AnalyzeTextProtectedMaterialResult:
      type: object
      required:
        - protectedMaterialAnalysis
      properties:
        protectedMaterialAnalysis:
          allOf:
            - $ref: '#/components/schemas/ProtectedMaterialAnalysisResult'
          description: Analysis result for protected material.
      description: The protected material analysis response.
    AnalyzeTextResult:
      type: object
      required:
        - categoriesAnalysis
      properties:
        blocklistsMatch:
          type: array
          items:
            $ref: '#/components/schemas/TextBlocklistMatch'
          description: The blocklist match details.
        categoriesAnalysis:
          type: array
          items:
            $ref: '#/components/schemas/TextCategoriesAnalysis'
          description: Analysis result for categories.
      description: The text analysis response.
    Azure.Core.Foundations.Error:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: One of a server-defined set of error codes.
        message:
          type: string
          description: A human-readable representation of the error.
        target:
          type: string
          description: The target of the error.
        details:
          type: array
          items:
            $ref: '#/components/schemas/Azure.Core.Foundations.Error'
          description: An array of details about specific errors that led to this reported error.
        innererror:
          allOf:
            - $ref: '#/components/schemas/Azure.Core.Foundations.InnerError'
          description: An object containing more specific information than the current object about the error.
      description: The error object.
    Azure.Core.Foundations.ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          allOf:
            - $ref: '#/components/schemas/Azure.Core.Foundations.Error'
          description: The error object.
      description: A response containing error details.
    Azure.Core.Foundations.InnerError:
      type: object
      properties:
        code:
          type: string
          description: One of a server-defined set of error codes.
        innererror:
          allOf:
            - $ref: '#/components/schemas/Azure.Core.Foundations.InnerError'
          description: Inner error.
      description: An object containing more specific information about the error. As per Microsoft One API guidelines - https://github.com/Microsoft/api-guidelines/blob/vNext/Guidelines.md#7102-error-condition-responses.
    ImageCategoriesAnalysis:
      type: object
      required:
        - category
      properties:
        category:
          allOf:
            - $ref: '#/components/schemas/ImageCategory'
          description: The image analysis category.
        severity:
          type: integer
          format: int32
          description: The value increases with the severity of the input content. The value of this field is determined by the output type specified in the request. The output type could be ‘FourSeverityLevels’, and the output value can be 0, 2, 4, 6.
      description: Image analysis result.
    ImageCategory:
      type: string
      enum:
        - Hate
        - SelfHarm
        - Sexual
        - Violence
      description: Image analyze category.
    ImageData:
      type: object
      properties:
        content:
          type: string
          format: byte
          description: The Base64 encoding of the image.
        blobUrl:
          type: string
          format: uri
          description: The blob url of the image.
      description: The image can be either base64 encoded bytes or a blob URL. You can choose only one of these options. If both are provided, the request will be refused. The maximum image size is 2048 x 2048 pixels and should not exceed 4 MB, while the minimum image size is 50 x 50 pixels.
    JailbreakAnalysisResult:
      type: object
      required:
        - detected
      properties:
        detected:
          type: boolean
          description: Analysis result for jailbreak.
      description: The text jailbreak analysis response.
    PagedTextBlocklist:
      type: object
      required:
        - value
      properties:
        value:
          type: array
          items:
            $ref: '#/components/schemas/TextBlocklist'
          description: The TextBlocklist items on this page
        nextLink:
          type: string
          format: uri
          description: The link to the next page of items
      description: Paged collection of TextBlocklist items
    PagedTextBlocklistItem:
      type: object
      required:
        - value
      properties:
        value:
          type: array
          items:
            $ref: '#/components/schemas/TextBlocklistItem'
          description: The TextBlocklistItem items on this page
        nextLink:
          type: string
          format: uri
          description: The link to the next page of items
      description: Paged collection of TextBlocklistItem items
    ProtectedMaterialAnalysisResult:
      type: object
      required:
        - detected
      properties:
        detected:
          type: boolean
          description: Analysis result for protected material..
      description: The text protected material analysis response.
    RemoveTextBlocklistItemsOptions:
      type: object
      required:
        - blocklistItemIds
      properties:
        blocklistItemIds:
          type: array
          items:
            type: string
          description: Array of blocklistItemIds to remove.
      description: The request to remove blocklistItems from a text blocklist.
    TextBlocklist:
      type: object
      required:
        - blocklistName
      properties:
        blocklistName:
          type: string
          maxLength: 64
          pattern: ^[0-9A-Za-z._~-]+$
          description: Text blocklist name.
        description:
          type: string
          maxLength: 1024
          description: Text blocklist description.
      description: Text Blocklist.
    TextBlocklistCreateOrUpdate:
      type: object
      properties:
        blocklistName:
          type: string
          maxLength: 64
          pattern: ^[0-9A-Za-z._~-]+$
          description: Text blocklist name.
        description:
          type: string
          maxLength: 1024
          description: Text blocklist description.
      description: Text Blocklist.
    TextBlocklistItem:
      type: object
      required:
        - blocklistItemId
        - text
      properties:
        blocklistItemId:
          type: string
          maxLength: 64
          description: The service will generate a BlocklistItemId, which will be a UUID.
          readOnly: true
        description:
          type: string
          maxLength: 1024
          description: BlocklistItem description.
        text:
          type: string
          maxLength: 128
          description: BlocklistItem content.
      description: Item in a TextBlocklist.
    TextBlocklistMatch:
      type: object
      required:
        - blocklistName
        - blocklistItemId
        - blocklistItemText
      properties:
        blocklistName:
          type: string
          maxLength: 64
          description: The name of the matched blocklist.
        blocklistItemId:
          type: string
          maxLength: 64
          description: The ID of the matched item.
        blocklistItemText:
          type: string
          maxLength: 128
          description: The content of the matched item.
      description: The result of blocklist match.
    TextCategoriesAnalysis:
      type: object
      required:
        - category
      properties:
        category:
          allOf:
            - $ref: '#/components/schemas/TextCategory'
          description: The text analysis category.
        severity:
          type: integer
          format: int32
          description: The value increases with the severity of the input content. The value of this field is determined by the output type specified in the request. The output type could be ‘FourSeverityLevels’ or ‘EightSeverity Levels’, and the output value can be 0, 2, 4, 6 or 0, 1, 2, 3, 4, 5, 6, or 7.
      description: Text analysis result.
    TextCategory:
      type: string
      enum:
        - Hate
        - SelfHarm
        - Sexual
        - Violence
      description: Text analyze category.
    Versions:
      type: string
      enum:
        - 2023-10-01
        - 2023-10-15-preview
        - 2023-10-30-preview
        - 2024-01-30-preview
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: Ocp-Apim-Subscription-Key
    OAuth2Auth:
      type: oauth2
      flows:
        clientCredentials:
          tokenUrl: https://login.microsoftonline.com/common/oauth2/v2.0/token
          refreshUrl: https://login.microsoftonline.com/common/oauth2/v2.0/token
          scopes:
            https://cognitiveservices.azure.com/.default: ''
servers:
  - url: '{endpoint}/contentsafety'
    description: Analyze harmful content
    variables:
      endpoint:
        default: ''
        description: |-
          Supported Cognitive Services endpoints (protocol and hostname, for example:
          https://<resource-name>.cognitiveservices.azure.com).
